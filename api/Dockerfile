# ============================================================
# ğŸ™ï¸ IluminaCity API - Dockerfile
# Node.js 20 LTS (Alpine)
# ============================================================

FROM node:20-alpine

WORKDIR /app

# Instalar dependÃªncias de sistema necessÃ¡rias (opcional, mas boa prÃ¡tica)
RUN apk add --no-cache curl

# Copiar arquivos de dependÃªncia primeiro (Cache Layer Optimization)
COPY package.json package-lock.json ./

# Instalar dependÃªncias (limpo e rÃ¡pido)
RUN npm ci

# Copiar o restante do cÃ³digo
COPY . .

# Buildar o TypeScript (se necessÃ¡rio)
# Se o seu projeto usa tsx/ts-node em dev, para prod geralmente buildamos
# Mas como o start script pode variar, vamos garantir que o build ocorra.
RUN npm run build

# Expor a porta da API
EXPOSE 3333

# Comando de inicializaÃ§Ã£o
CMD ["npm", "start"]
